Starting at Wed Jun  7 10:24:45 AM UTC 2023
Current working directory is /home/leonkl/cme-213/final_project
The master node of this job is: icmet01
Number of compute nodes: 1
Compute node names: icmet01
Using 4 tasks per node.
Number of CPUs on node: 4.
----------------

* Mode 1 *
mpirun -np 2 ./main -g 1
Number of MPI processes         2
Number of CUDA devices          4
Grading mode on; grading mode   1
Number of neurons            1000
Number of epochs               40
Batch size                    800
Regularization      9.9999997e-05
Learning rate       0.00050000002
The sequential code is not run
The debug option is on
The output directory is ./Outputs
The CPU results are loaded from ./cpu_results
Loading training data
Training data information:
Size of x_train, N =  60000
Size of label_train = 60000
Loading testing data

Start Parallel Training
The error in the GPU calculation during training is saved to ./Outputs/CpuGpuDiff-2-1.txt
TEST1-----1
TEST2-----1
TEST1-----0
TEST2-----0
TEST1-----1
TEST2-----1
terminate called after throwing an instance of 'std::out_of_range'
  what():  Mat::elem(): index out of bounds
[icmet01:1140142] *** Process received signal ***
[icmet01:1140142] Signal: Aborted (6)
[icmet01:1140142] Signal code:  (-6)
[icmet01:1140142] [ 0] /lib/x86_64-linux-gnu/libc.so.6(+0x42520)[0x7f45fa3f0520]
[icmet01:1140142] [ 1] /lib/x86_64-linux-gnu/libc.so.6(pthread_kill+0x12c)[0x7f45fa444a7c]
[icmet01:1140142] [ 2] /lib/x86_64-linux-gnu/libc.so.6(raise+0x16)[0x7f45fa3f0476]
[icmet01:1140142] [ 3] /lib/x86_64-linux-gnu/libc.so.6(abort+0xd3)[0x7f45fa3d67f3]
[icmet01:1140142] [ 4] /lib/x86_64-linux-gnu/libstdc++.so.6(+0xa2bbe)[0x7f45fa678bbe]
[icmet01:1140142] [ 5] /lib/x86_64-linux-gnu/libstdc++.so.6(+0xae24c)[0x7f45fa68424c]
[icmet01:1140142] [ 6] /lib/x86_64-linux-gnu/libstdc++.so.6(+0xae2b7)[0x7f45fa6842b7]
[icmet01:1140142] [ 7] /lib/x86_64-linux-gnu/libstdc++.so.6(+0xae518)[0x7f45fa684518]
[icmet01:1140142] [ 8] ./main(+0x5120b)[0x5638ee73120b]
[icmet01:1140142] [ 9] ./main(+0x51661)[0x5638ee731661]
[icmet01:1140142] [10] ./main(+0x6239a)[0x5638ee74239a]
[icmet01:1140142] [11] ./main(+0x574c1)[0x5638ee7374c1]
[icmet01:1140142] [12] /lib/x86_64-linux-gnu/libc.so.6(+0x29d90)[0x7f45fa3d7d90]
[icmet01:1140142] [13] /lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0x80)[0x7f45fa3d7e40]
[icmet01:1140142] [14] ./main(+0x5c4e5)[0x5638ee73c4e5]
[icmet01:1140142] *** End of error message ***
--------------------------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code. Per user-direction, the job has been aborted.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
mpirun noticed that process rank 0 with PID 1140142 on node icmet01 exited on signal 6 (Aborted).
--------------------------------------------------------------------------

* Mode 2 *
mpirun -np 2 ./main -g 2
Number of MPI processes         2
Number of CUDA devices          4
Grading mode on; grading mode   2
Number of neurons            1000
Number of epochs               10
Batch size                    800
Regularization      9.9999997e-05
Learning rate               0.001
The sequential code is not run
The debug option is on
The output directory is ./Outputs
The CPU results are loaded from ./cpu_results
Loading training data
Training data information:
Size of x_train, N =  60000
Size of label_train = 60000
Loading testing data

Start Parallel Training
The error in the GPU calculation during training is saved to ./Outputs/CpuGpuDiff-2-2.txt
TEST1-----1
TEST2-----1
TEST1-----0
TEST2-----0
TEST1-----1
TEST2-----1
terminate called after throwing an instance of 'std::out_of_range'
  what():  Mat::elem(): index out of bounds
[icmet01:1140169] *** Process received signal ***
[icmet01:1140169] Signal: Aborted (6)
[icmet01:1140169] Signal code:  (-6)
[icmet01:1140169] [ 0] /lib/x86_64-linux-gnu/libc.so.6(+0x42520)[0x7f055e3f0520]
[icmet01:1140169] [ 1] /lib/x86_64-linux-gnu/libc.so.6(pthread_kill+0x12c)[0x7f055e444a7c]
[icmet01:1140169] [ 2] /lib/x86_64-linux-gnu/libc.so.6(raise+0x16)[0x7f055e3f0476]
[icmet01:1140169] [ 3] /lib/x86_64-linux-gnu/libc.so.6(abort+0xd3)[0x7f055e3d67f3]
[icmet01:1140169] [ 4] /lib/x86_64-linux-gnu/libstdc++.so.6(+0xa2bbe)[0x7f055e678bbe]
[icmet01:1140169] [ 5] /lib/x86_64-linux-gnu/libstdc++.so.6(+0xae24c)[0x7f055e68424c]
[icmet01:1140169] [ 6] /lib/x86_64-linux-gnu/libstdc++.so.6(+0xae2b7)[0x7f055e6842b7]
[icmet01:1140169] [ 7] /lib/x86_64-linux-gnu/libstdc++.so.6(+0xae518)[0x7f055e684518]
[icmet01:1140169] [ 8] ./main(+0x5120b)[0x559caf05920b]
[icmet01:1140169] [ 9] ./main(+0x51661)[0x559caf059661]
[icmet01:1140169] [10] ./main(+0x6239a)[0x559caf06a39a]
[icmet01:1140169] [11] ./main(+0x574c1)[0x559caf05f4c1]
[icmet01:1140169] [12] /lib/x86_64-linux-gnu/libc.so.6(+0x29d90)[0x7f055e3d7d90]
[icmet01:1140169] [13] /lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0x80)[0x7f055e3d7e40]
[icmet01:1140169] [14] ./main(+0x5c4e5)[0x559caf0644e5]
[icmet01:1140169] *** End of error message ***
--------------------------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code. Per user-direction, the job has been aborted.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
mpirun noticed that process rank 0 with PID 1140169 on node icmet01 exited on signal 6 (Aborted).
--------------------------------------------------------------------------

* Mode 3 *
mpirun -np 2 ./main -g 3
Number of MPI processes         2
Number of CUDA devices          4
Grading mode on; grading mode   3
Number of neurons            1000
Number of epochs                1
Batch size                    800
Regularization      9.9999997e-05
Learning rate        0.0020000001
The sequential code is not run
The debug option is on
The output directory is ./Outputs
The CPU results are loaded from ./cpu_results
Loading training data
Training data information:
Size of x_train, N =  60000
Size of label_train = 60000
Loading testing data

Start Parallel Training
The error in the GPU calculation during training is saved to ./Outputs/CpuGpuDiff-2-3.txt
TEST1-----1
TEST2-----1
TEST1-----0
TEST2-----0
TEST1-----1
TEST2-----1
terminate called after throwing an instance of 'std::out_of_range'
  what():  Mat::elem(): index out of bounds
[icmet01:1140188] *** Process received signal ***
[icmet01:1140188] Signal: Aborted (6)
[icmet01:1140188] Signal code:  (-6)
[icmet01:1140188] [ 0] /lib/x86_64-linux-gnu/libc.so.6(+0x42520)[0x7f38fe1f0520]
[icmet01:1140188] [ 1] /lib/x86_64-linux-gnu/libc.so.6(pthread_kill+0x12c)[0x7f38fe244a7c]
[icmet01:1140188] [ 2] /lib/x86_64-linux-gnu/libc.so.6(raise+0x16)[0x7f38fe1f0476]
[icmet01:1140188] [ 3] /lib/x86_64-linux-gnu/libc.so.6(abort+0xd3)[0x7f38fe1d67f3]
[icmet01:1140188] [ 4] /lib/x86_64-linux-gnu/libstdc++.so.6(+0xa2bbe)[0x7f38fe478bbe]
[icmet01:1140188] [ 5] /lib/x86_64-linux-gnu/libstdc++.so.6(+0xae24c)[0x7f38fe48424c]
[icmet01:1140188] [ 6] /lib/x86_64-linux-gnu/libstdc++.so.6(+0xae2b7)[0x7f38fe4842b7]
[icmet01:1140188] [ 7] /lib/x86_64-linux-gnu/libstdc++.so.6(+0xae518)[0x7f38fe484518]
[icmet01:1140188] [ 8] ./main(+0x5120b)[0x55f7df86120b]
[icmet01:1140188] [ 9] ./main(+0x51661)[0x55f7df861661]
[icmet01:1140188] [10] ./main(+0x6239a)[0x55f7df87239a]
[icmet01:1140188] [11] ./main(+0x574c1)[0x55f7df8674c1]
[icmet01:1140188] [12] /lib/x86_64-linux-gnu/libc.so.6(+0x29d90)[0x7f38fe1d7d90]
[icmet01:1140188] [13] /lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0x80)[0x7f38fe1d7e40]
[icmet01:1140188] [14] ./main(+0x5c4e5)[0x55f7df86c4e5]
[icmet01:1140188] *** End of error message ***
--------------------------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code. Per user-direction, the job has been aborted.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
mpirun noticed that process rank 0 with PID 1140188 on node icmet01 exited on signal 6 (Aborted).
--------------------------------------------------------------------------

*** Summary ***


*** Grading mode 4 ***

main -g 4
Number of MPI processes         4
Number of CUDA devices          4

Entering GEMM Benchmarking mode! Stand by.

Starting GEMM 1: M = 8003; N = 10000; K = 7840
GEMM matched with reference successfully! Rel diff = 4.99265e-08
Time for reference GEMM implementation: 0.490195 seconds
Time for my GEMM implementation: 4.96387 seconds
Completed GEMM 1

Starting GEMM 2: M = 8000; N = 1000; K = 10000
GEMM matched with reference successfully! Rel diff = 5.08913e-08
Time for reference GEMM implementation: 0.0633054 seconds
Time for my GEMM implementation: 0.698493 seconds
Completed GEMM 2

Starting GEMM 3: M = 8000; N = 100; K = 10000
GEMM matched with reference successfully! Rel diff = 1.07542e-06
Time for reference GEMM implementation: 0.00815351 seconds
Time for my GEMM implementation: 0.0857802 seconds
Completed GEMM 3

*** Tests are complete ***
